<!DOCTYPE html>
<html>
<head>
<title>Map with Location Pins and Custom Boundaries</title>
<style>
        #map {
            height: 550px;
            width: 100%;
        }
</style>
</head>
<body>
<div id="map"></div>
<script>
        var map;
        var markers = [];
        var areas = ['Kingfisher South', 'NRK Site', 'NRK Site', 'Remediation pad', 'Kingfisher North', 'NRK Wiles'];
        var Area1 = [
            { lat: 44.677800, lng: -79.254949 },
            { lat: 44.674293, lng: -79.253364 },
            { lat: 44.671456, lng: -79.252075 },
            { lat: 44.669178, lng: -79.251048 },
            { lat: 44.669728, lng: -79.248582 },
            { lat: 44.670264, lng: -79.246269 },
            { lat: 44.671404, lng: -79.241352 },
            { lat: 44.673639, lng: -79.242433 },
            { lat: 44.675694, lng: -79.243353 },
            { lat: 44.679276, lng: -79.244956 },
            { lat: 44.680008, lng: -79.245283 },
            { lat: 44.678904, lng: -79.250116 }
        ];
        var Area2 = [
            { lat: 44.682875, lng: -79.246583 },
            { lat: 44.682418, lng: -79.248275 },
            { lat: 44.681744, lng: -79.248099 },
            { lat: 44.680159, lng: -79.247830 },
            { lat: 44.679827, lng: -79.247758 },
            { lat: 44.679654, lng: -79.247666 },
            { lat: 44.680189, lng: -79.245320 }
        ];
        var Area3 = [
            { lat: 44.682875, lng: -79.246583 },
            { lat: 44.682418, lng: -79.248275 },
            { lat: 44.681744, lng: -79.248099 },
            { lat: 44.680159, lng: -79.247830 },
            { lat: 44.679827, lng: -79.247758 },
            { lat: 44.679654, lng: -79.247666 },
            { lat: 44.679576, lng: -79.248006 },
            { lat: 44.679660, lng: -79.248044 },
            { lat: 44.679752, lng: -79.247975 },
            { lat: 44.680092, lng: -79.247970 },
            { lat: 44.681692, lng: -79.248228 },
            { lat: 44.682480, lng: -79.248500 },
            { lat: 44.682801, lng: -79.248560 },
            { lat: 44.682918, lng: -79.248492 },
            { lat: 44.683099, lng: -79.248459 },
            { lat: 44.683780, lng: -79.248600 },
            { lat: 44.683027, lng: -79.251746 },
            { lat: 44.683356, lng: -79.251894 },
            { lat: 44.683569, lng: -79.252203 },
            { lat: 44.683579, lng: -79.252293 },
            { lat: 44.684235, lng: -79.253161 },
            { lat: 44.684629, lng: -79.252404 },
            { lat: 44.684810, lng: -79.251958 },
            { lat: 44.684778, lng: -79.251438 },
            { lat: 44.684961, lng: -79.250873 },
            { lat: 44.685127, lng: -79.250282 },
            { lat: 44.686105, lng: -79.249521 },
            { lat: 44.686352, lng: -79.249211 },
            { lat: 44.686815, lng: -79.248435 }
        ];
        var Area4 = [
            { lat: 44.679576, lng: -79.248006 },
            { lat: 44.679660, lng: -79.248044 },
            { lat: 44.679752, lng: -79.247975 },
            { lat: 44.680092, lng: -79.247970 },
            { lat: 44.681692, lng: -79.248228 },
            { lat: 44.682480, lng: -79.248500 },
            { lat: 44.682801, lng: -79.248560 },
            { lat: 44.682918, lng: -79.248492 },
            { lat: 44.683099, lng: -79.248459 },
            { lat: 44.683780, lng: -79.248600 },
            { lat: 44.683027, lng: -79.251746 },
            { lat: 44.682984, lng: -79.251925 },
            { lat: 44.679081, lng: -79.250174 }
        ];
        var Area5 = [
            { lat: 44.683027, lng: -79.251746 },
            { lat: 44.683356, lng: -79.251894 },
            { lat: 44.683569, lng: -79.252203 },
            { lat: 44.683579, lng: -79.252293 },
            { lat: 44.684235, lng: -79.253161 },
            { lat: 44.684629, lng: -79.252404 },
            { lat: 44.684810, lng: -79.251958 },
            { lat: 44.684778, lng: -79.251438 },
            { lat: 44.684961, lng: -79.250873 },
            { lat: 44.685127, lng: -79.250282 },
            { lat: 44.686105, lng: -79.249521 },
            { lat: 44.686352, lng: -79.249211 },
            { lat: 44.686815, lng: -79.248435 },
            { lat: 44.687011, lng: -79.248528 },
            { lat: 44.688782, lng: -79.249343 },
            { lat: 44.689614, lng: -79.245504 },
            { lat: 44.690369, lng: -79.245861 },
            { lat: 44.690607, lng: -79.244756 },
            { lat: 44.698469, lng: -79.248463 },
            { lat: 44.697449, lng: -79.253210 },
            { lat: 44.697431, lng: -79.253294 },
            { lat: 44.696474, lng: -79.257732 },
            { lat: 44.696381, lng: -79.258172 },
            { lat: 44.692069, lng: -79.256120 },
            { lat: 44.691011, lng: -79.261031 },
            { lat: 44.686670, lng: -79.259002 },
            { lat: 44.683353, lng: -79.257530 },
            { lat: 44.682335, lng: -79.257041 },
            { lat: 44.683455, lng: -79.252137 },
            { lat: 44.682984, lng: -79.251925 }
        ];
        var Area6 = [
            { lat: 44.679081, lng: -79.250174 },
            { lat: 44.682984, lng: -79.251925 },
            { lat: 44.683455, lng: -79.252137 },
            { lat: 44.682335, lng: -79.257041 },
            { lat: 44.683353, lng: -79.257530 },
            { lat: 44.686670, lng: -79.259002 },
            { lat: 44.685613, lng: -79.263841 },
            { lat: 44.685613, lng: -79.263841 },
            { lat: 44.681899, lng: -79.262158 },
            { lat: 44.679878, lng: -79.261234 },
            { lat: 44.676865, lng: -79.259864 },
            { lat: 44.677972, lng: -79.255028 }
        ];
        var Field3 = [
            { lat: 44.676865, lng: -79.259864 },
            { lat: 44.677972, lng: -79.255028 },
            { lat: 44.682335, lng: -79.257041 },
            { lat: 44.68133048356872, lng: -79.2618537077951 }
        ];
        var Field2 = [
            { lat: 44.677972, lng: -79.255028 },
            { lat: 44.679081, lng: -79.250174 },
            { lat: 44.683455, lng: -79.252137 },
            { lat: 44.682335, lng: -79.257041 }
        ];
        var Field5 = [
            { lat: 44.67641338286477, lng: -79.24369857021824 },
            { lat: 44.680008, lng: -79.245283 },
            { lat: 44.67937687086426, lng: -79.24803583198144 },
            { lat: 44.67573638019998, lng: -79.24628390624241 }
        ];
       
       
        var Field1 = [
            { lat: 44.682875, lng: -79.246583 },
            { lat: 44.682418, lng: -79.248275 },
            { lat: 44.681744, lng: -79.248099 },
            { lat: 44.680159, lng: -79.247830 },
            { lat: 44.679827, lng: -79.247758 },
            { lat: 44.679654, lng: -79.247666 },
            { lat: 44.680189, lng: -79.245320 }
        ];
        var Field4 = [
            { lat: 44.682875, lng: -79.246583 },
            { lat: 44.682418, lng: -79.248275 },
            { lat: 44.681744, lng: -79.248099 },
            { lat: 44.680159, lng: -79.247830 },
            { lat: 44.679827, lng: -79.247758 },
            { lat: 44.679654, lng: -79.247666 },
            { lat: 44.679576, lng: -79.248006 },
            { lat: 44.679660, lng: -79.248044 },
            { lat: 44.679752, lng: -79.247975 },
            { lat: 44.680092, lng: -79.247970 },
            { lat: 44.681692, lng: -79.248228 },
            { lat: 44.682480, lng: -79.248500 },
            { lat: 44.682801, lng: -79.248560 },
            { lat: 44.682918, lng: -79.248492 },
            { lat: 44.683099, lng: -79.248459 },
            { lat: 44.683780, lng: -79.248600 },
            { lat: 44.683027, lng: -79.251746 },
            { lat: 44.683356, lng: -79.251894 },
            { lat: 44.683569, lng: -79.252203 },
            { lat: 44.683579, lng: -79.252293 },
            { lat: 44.684235, lng: -79.253161 },
            { lat: 44.684629, lng: -79.252404 },
            { lat: 44.684810, lng: -79.251958 },
            { lat: 44.684778, lng: -79.251438 },
            { lat: 44.684961, lng: -79.250873 },
            { lat: 44.685127, lng: -79.250282 },
            { lat: 44.686105, lng: -79.249521 },
            { lat: 44.686352, lng: -79.249211 },
            { lat: 44.686815, lng: -79.248435 }
        ];
        var Berm1 = [
            { lat: 44.679654, lng: -79.247666 },
            { lat: 44.680189, lng: -79.245320 },
            { lat: 44.680383224061465, lng: -79.24541269995574 },
            { lat: 44.6798243143939, lng: -79.2477568571749 }
        ];
        var Berm2 = [
            { lat: 44.680383224061465, lng: -79.24541269995574 },
            { lat: 44.68657938064624, lng: -79.24833277667382 },
            { lat: 44.68648498069934, lng: -79.24898109920927 },
            { lat: 44.68023643336509, lng: -79.24602510469687 },
        ];
        var Berm3 = [
            { lat: 44.679081, lng: -79.250174 },
            { lat: 44.679576, lng: -79.248006 },
            { lat: 44.679660, lng: -79.248044 },
            { lat: 44.679752, lng: -79.247975 },
            { lat: 44.679235653289744, lng: -79.25024053943174 }
        ];
        var Berm4 = [
            { lat: 44.679081, lng: -79.250174 },
            { lat: 44.679235653289744, lng: -79.25024053943174 },
            { lat: 44.67940087239385, lng: -79.24951747951978 },
            { lat: 44.680904909900725, lng: -79.2501744932097 },
            { lat: 44.68055399481689, lng:  -79.25192329348741 },
            { lat: 44.678848564038574, lng:  -79.2511973268695 },
        ];
        var Berm5 = [
            { lat: 44.68090560301521, lng: -79.25017167159915 },
            { lat: 44.68208710118475, lng:  -79.25073442459593},
            { lat:  44.68174487411514, lng:  -79.25246547457115 },
            { lat: 44.680551486768636, lng:   -79.25192510478018 },
           
        ];
        var Berm6 = [
            { lat: 44.678847616766234, lng:  -79.25119829028573 },
            { lat: 44.679611500668905, lng:   -79.25151419129642},
            { lat: 44.67871239850435, lng:  -79.25536994237738 },
            { lat: 44.677974128622566, lng:   -79.25502692349725 },
        ];
        var Berm7 = [
            { lat: 44.67686805388615, lng:   -79.25986223240368 },
            { lat: 44.6775895117714, lng:  -79.26018626001067 },
            { lat: 44.67871239850435, lng:  -79.25536994237738 },
            { lat: 44.677974128622566, lng:   -79.25502692349725 },
        ];
        var Berm8 = [
            { lat: 44.6775895117714, lng:  -79.26018626001067 },
            { lat: 44.67781449108261, lng:  -79.25922067716691 },
            { lat: 44.68325862584927, lng:  -79.26176158797401 },
            { lat:  44.68304100713573, lng:   -79.26267421494187 },
        ];
        var Berm9 = [
            {lat: 44.68194362985116, lng:   -79.25145677519765 },
            { lat: 44.6834533275708, lng:  -79.25213828936648},
            { lat:  44.68436688954772, lng:   -79.24797277468448},
            { lat:  44.68284987038534, lng:   -79.2472644782201},
        ];
        var Berm10 = [
            { lat: 44.6834533275708, lng:  -79.25213828936648},
            { lat:  44.68436688954772, lng:   -79.24797277468448},
            { lat: 44.685786820686516, lng:  -79.24865709779704},
            { lat:  44.68564188997096, lng:   -79.24904955249553},
            { lat:  44.684802810280836, lng:   -79.24981129985576},
            { lat:  44.68427647227225, lng:   -79.25109876018291},
            { lat:  44.68368147572146, lng:   -79.2524291358543},
        ];
 
        var Berm11 = [
            { lat: 44.679276, lng: -79.244956 },
            { lat: 44.680008, lng: -79.245283 },
            { lat: 44.677800, lng: -79.254949 },
            { lat: 44.677036568604564, lng: -79.25459851163751 }
        ];
 
        var Berm13 = [
            { lat: 44.679276, lng: -79.244956 },
            { lat: 44.674037764238825, lng: -79.24261205948918 },
            { lat: 44.67387523777908, lng: -79.24326456020425 },
            { lat: 44.67910100734973, lng: -79.24570976451318 }
        ];
 
        var Berm12 = [
            { lat: 44.677036568604564, lng: -79.25459851163751 },
            { lat: 44.67199596733232, lng: -79.25231794727137 },
            { lat: 44.672159346869776, lng: -79.2515475537802 },
            { lat: 44.677207180879314, lng: -79.25385982342817 }
        ];
 
 
        var webhookURL = 'https://hook.us1.make.com/w0zay6l1w638gyxr8ya55bp0u4c7tg9f';
       
 
        function initMap() {
            var mapCenter = { lat: 44.682, lng: -79.250 };
            map = new google.maps.Map(document.getElementById('map'), {
                zoom: 14,
                center: mapCenter,
                mapTypeId: 'satellite'
            });
            drawfieldBoundary(Field1, '#FFFF00');
            drawfieldBoundary(Field4, '#FFA500');
            drawfieldBoundary(Field3, '#008000');
            drawfieldBoundary(Field2, ' #BA55D3');
            drawfieldBoundary(Field5, ' #00008B');
            drawBermBoundary(Berm1, '#A9A9A9');
            drawBermBoundary(Berm2, '#A9A9A9');
            drawBermBoundary(Berm3, '#A9A9A9');
            drawBermBoundary(Berm4, '#A9A9A9');
            drawBermBoundary(Berm5, '#A9A9A9');
            drawBermBoundary(Berm6, '#A9A9A9');
            drawBermBoundary(Berm7, '#A9A9A9');
            drawBermBoundary(Berm8, '#A9A9A9');
            drawBermBoundary(Berm9, '#A9A9A9');
            drawBermBoundary(Berm10, '#A9A9A10');
            drawBermBoundary(Berm11, '#A9A9A9'); // Added berm1 boundary
            drawBermBoundary(Berm12, '#A9A9A9');
            drawBermBoundary(Berm13, '#A9A9A9');
            drawAreaBoundary(Area6, '#00FFFF');
            drawAreaBoundary(Area1, '#00FFFF');
            drawAreaBoundary(Area2, '#FFFF00');
            drawAreaBoundary(Area3, '#FFA500');
            drawAreaBoundary(Area4, '#FFFF00');
            drawAreaBoundary(Area5, '#FF0000');
            // Add pins for existing areas
            addPin({ lat: 44.680284427372506, lng: 79.2495564914556 }, 'red', '1')
            addPin({ lat: 44.680609, lng: -79.249704 }, '#0000FF', '1');
            addPin({ lat: 44.680879, lng: -79.249855 }, '#800080', '2');
            addPin({ lat: 44.681133, lng: -79.249981 }, '#CFFF04', '3');
            addPin({ lat: 44.681421, lng: -79.250098 }, '#FFA500', '4');
            addPin({ lat: 44.681740, lng: -79.250228 }, '#FF00FF', '5');
            map.addListener('click', function (event) {
                var areaName = getAreaName(event.latLng);
                var fieldName = getFieldName(event.latLng); // Get the field name
                var bermName = getBermName(event.latLng); // Get the berm name
                if (areaName) {
                    addMarker(event.latLng, areaName, fieldName, bermName); // Pass the field name and berm name to addMarker function
                } else {
                    alert('Please select a berm location within the ESS boundaries');
                }
            });
        }
 
        function getFieldName(location) {
            // Determine which field the location belongs to
            var field1Path = google.maps.geometry.poly.containsLocation(location, new google.maps.Polygon({ paths: Field1 }));
            var field2Path = google.maps.geometry.poly.containsLocation(location, new google.maps.Polygon({ paths: Field2 }));
            var field3Path = google.maps.geometry.poly.containsLocation(location, new google.maps.Polygon({ paths: Field3 }));
            var field4Path = google.maps.geometry.poly.containsLocation(location, new google.maps.Polygon({ paths: Field4 }));
            var field5Path = google.maps.geometry.poly.containsLocation(location, new google.maps.Polygon({ paths: Field5 }));
 
 
            if (field1Path) {
                return 'field1';
            } else if (field2Path) {
                return 'field2';
            }  else if (field3Path) {
                return 'field3';
            }  else if (field4Path) {
                return 'field4';
            }   else if (field5Path) {
                return 'field5';
            } else {
                return null;
            }
        }
 
        function getBermName(location) {
            // Determine if the location is within berm1
            var berm1Path = google.maps.geometry.poly.containsLocation(location, new google.maps.Polygon({ paths: Berm1 }));
            var berm2Path = google.maps.geometry.poly.containsLocation(location, new google.maps.Polygon({ paths: Berm2 }));
            var berm3Path = google.maps.geometry.poly.containsLocation(location, new google.maps.Polygon({ paths: Berm3 }));
            var berm4Path = google.maps.geometry.poly.containsLocation(location, new google.maps.Polygon({ paths: Berm4 }));
            var berm5Path = google.maps.geometry.poly.containsLocation(location, new google.maps.Polygon({ paths: Berm5 }));
            var berm6Path = google.maps.geometry.poly.containsLocation(location, new google.maps.Polygon({ paths: Berm6 }));
            var berm7Path = google.maps.geometry.poly.containsLocation(location, new google.maps.Polygon({ paths: Berm7 }));
            var berm8Path = google.maps.geometry.poly.containsLocation(location, new google.maps.Polygon({ paths: Berm8 }));
            var berm9Path = google.maps.geometry.poly.containsLocation(location, new google.maps.Polygon({ paths: Berm9 }));
            var berm10Path = google.maps.geometry.poly.containsLocation(location, new google.maps.Polygon({ paths: Berm10 }));
            var berm11Path = google.maps.geometry.poly.containsLocation(location, new google.maps.Polygon({ paths: Berm11 }));
            var berm12Path = google.maps.geometry.poly.containsLocation(location, new google.maps.Polygon({ paths: Berm12 }));
            var berm13Path = google.maps.geometry.poly.containsLocation(location, new google.maps.Polygon({ paths: Berm13 }));
 
            if (berm1Path) {
                return 'berm1';
            } else if (berm2Path) {
                return 'berm2';
            } else if (berm3Path) {
                return 'berm3';
            }  else if (berm4Path) {
                return 'berm4';
            } else if (berm5Path) {
                return 'berm5';
            } else if (berm6Path) {
                return 'berm6';
            } else if (berm7Path) {
                return 'berm7';
            } else if (berm8Path) {
                return 'berm8';
            } else if (berm9Path) {
                return 'berm9';
            }  else if (berm10Path) {
                return 'berm10';
            } else if (berm11Path) {
                return 'berm11';
            } else if (berm12Path) {
                return 'berm12';
            } else if (berm13Path) {
                return 'berm13';
            } else {
                return null;
            }
        }
 
        // Function to get the area name
        function getAreaName(location) {
            for (var i = 0; i < areas.length; i++) {
                var path = google.maps.geometry.poly.containsLocation(location, new google.maps.Polygon({ paths: window['Area' + (i + 1)] }));
                if (path) {
                    return areas[i];
                }
            }
            return null;
        }
 
        function drawAreaBoundary(coords, color) {
            var customBoundary = new google.maps.Polygon({
                paths: coords,
                strokeColor: color,
                strokeOpacity: 0.8,
                strokeWeight: 2,
                fillOpacity: 0,
                clickable: false
            });
            customBoundary.setMap(map);
        }
        function drawfieldBoundary(coords, color) {
            var customBoundary = new google.maps.Polygon({
                paths: coords,
                strokeColor: color,
                strokeOpacity: 0.8,
                strokeWeight: 2,
                fillColor: color,
                fillOpacity: 0.35,
                clickable: false
            });
            customBoundary.setMap(map);
        }
 
        function drawBermBoundary(coords, color) {
            var customBoundary = new google.maps.Polygon({
                paths: coords,
                strokeColor: '#A9A9A9',
                strokeOpacity: 0.8,
                strokeWeight: 2,
                fillColor: color,
                fillOpacity: 0.35,
                clickable: false
            });
            customBoundary.setMap(map);
        }
 
        function addPin(location, color, number) {
            var pin = new google.maps.Marker({
                position: location,
                map: map,
                icon: {
                    path: google.maps.SymbolPath.CIRCLE,
                    fillColor: color,
                    fillOpacity: 1,
                    strokeColor: '#FFFFFF',
                    strokeWeight: 1,
                    scale: 7
                },
                label: {
                    text: number,
                    color: 'white',
                    fontSize: '12px',
                    fontWeight: 'bold'
                }
            });
            markers.push(pin);
        }
 
        function addMarker(location, areaName, fieldName, bermName) {
            clearMarkers();
            var marker = new google.maps.Marker({
                position: location,
                map: map
            });
            markers.push(marker);
            var infowindowContent = 'Area: ' + areaName + '<br>Latitude: ' + location.lat() + '<br>Longitude: ' + location.lng();
            if (fieldName) {
                infowindowContent += '<br>Field: ' + fieldName; // Include field name if available
            }
            if (bermName) {
                infowindowContent += '<br>Berm: ' + bermName; // Include berm name if available
            }
            var infowindow = new google.maps.InfoWindow({
                content: infowindowContent
            });
            infowindow.open(map, marker);
            fetch(webhookURL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ area: areaName, latitude: location.lat(), longitude: location.lng(), field: fieldName, berm: bermName })
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    console.log('Webhook triggered successfully:', data);
                })
                .catch(error => {
                    console.error('There was a problem triggering the webhook:', error);
                });
            marker.addListener('click', function () {
                infowindow.open(map, marker);
            });
        }
 
        function clearMarkers() {
            for (var i = 5; i < markers.length; i++) {
                markers[i].setMap(null);
            }
            markers = [markers[0], markers[1], markers[2], markers[3], markers[4]];
        }
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDEO0_2kf8146iPb4DiTgSZqgsMCtQYktQ&callback=initMap" async defer></script>
</body>
</html>
